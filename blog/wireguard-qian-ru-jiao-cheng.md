---
description: æœåŠ¡ç«¯åˆ°å¦ä¸€å°æœå‹™ç«¯/å®¢æˆ¶ç«¯
---

# ğŸŒ Wireguard æ·ºå…¥æ•™ç¨‹

é€™æ˜¯ä¸€å€‹æˆ‘è‡ªå·±éƒ½é›£ä»¥è©®é‡‹çš„æ•™ç¨‹ï¼å¦‚æœ‰ç–‘å•ï¼Œè«‹ç§è¨Šï¼Œæˆ–è€…æˆ‘å¯«çš„æœ‰éŒ¯èª¤ï¼Œæ­¡è¿æŒ‡æ­£ã€‚

è¯çµ¡æˆ‘çš„æ–¹å¼ è«‹åœ¨å´æ¬„ æ‰¾åˆ° About-Me

### ç«¯åˆ°ç«¯ å»ºç«‹Wireguardï¼ˆä»¥ä¸‹æœ¬æ–‡ç°¡ç¨±ç‚ºwg

é³´è¬æ•™ç¨‹ä¾†æº ZHï¼Œæ„Ÿè¬æ›¾éå»å¹«åŠ©æˆ‘é…ç½®wgï¼Œæ‰€å¾—æ­¤æ•™ç¨‹ã€‚

ç³»çµ±ç’°å¢ƒDebian11

wgä¾è³´å…§æ ¸ï¼Œè‹¥å…§æ ¸è¼ƒä½ ç„¡æ³•ä½¿ç”¨wgï¼Œæœ¬ç¯‡ä¸åœ¨æ­¤ éå¤šè§£é‡‹ å…§æ ¸å‡ç´š

### Start

å®‰è£…Wireguard  Debian 11

```
apt install wireguard-dkms wireguard-tools -y
```

Debian 12

```
apt install wireguard
```

é€²å…¥  `/etc/wireguard` ç›®éŒ„

ç”Ÿæˆå…¬é’¥ï¼Œç§˜é’¥

```
wg genkey | tee privatekey | wg pubkey > publickey 
```

çµ¦äºˆæ­¤ç›®éŒ„777 æ¬Šé™

```
chmod 777 -R /etc/wireguard
```

åˆ©ç”¨ touch å‰µå»ºä¸€å€‹ç¶²å¡é…ç½®

```
touch xxx.conf
```

å¯åŠ¨æ­¤ç½‘å¡é…ç½®å‘½ä»¤

```
wg-quick up xxx.conf
```

ç»“æŸå°±æ˜¯å°†`up` æ›¿æ¢ä¸º `down`

### ç½‘å¡é…ç½®è¯¦ç»†

ä»¥ä¸‹ä¸ºæœåŠ¡å™¨A é…ç½®&#x20;

```
[Interface]
PrivateKey = #[æ­¤è™•å¡«å¯«æœå‹™å™¨Aç”Ÿæˆçš„ å¯†é‘° PrivateKey]
Address =  #[æ­¤è™•å¡«å¯«æœå‹™å™¨A ifup link local address]
ListenPort = #[æ­¤è™•å¡«å¯«æœå‹™å™¨B å°ç«¯çš„ç«¯å£]
table = off


[Peer]
PublicKey = #[æ­¤è™•å¡«å¯«æœå‹™å™¨Bç«¯çš„å…¬é‘° PublicKey]
AllowedIPs = ::/0
EndPoint = [255.255.255.255]:00000 #[æ­¤è™•å¡«å¯«æœå‹™å™¨bç«¯çš„ip/åŸŸåï¼šç«¯å£]
PersistentKeepalive = 25 #[ä¿æ´»ï¼Œé»˜èªç‚º25]
```

ä»¥ä¸‹ç‚ºæœå‹™å™¨bç«¯é…ç½®

```
[Interface]
PrivateKey = #[æ­¤è™•å¡«å¯«æœå‹™å™¨Bç”Ÿæˆçš„ å¯†é‘° PrivateKey]
Address =  #[æ­¤è™•å¡«å¯«æœå‹™å™¨B ifup link local address]
ListenPort = #[æ­¤è™•å¡«å¯«æœå‹™å™¨A å°ç«¯çš„ç«¯å£]
table = off


[Peer]
PublicKey = #[æ­¤è™•å¡«å¯«æœå‹™å™¨Aç«¯çš„å…¬é‘° PublicKey]
AllowedIPs = ::/0
EndPoint = [255.255.255.255]:00000 #[æ­¤è™•å¡«å¯«æœå‹™å™¨Aç«¯çš„ip/åŸŸåï¼šç«¯å£]
PersistentKeepalive = 25 #[ä¿æ´»ï¼Œé»˜èªç‚º25]
```

è‡³æ­¤ï¼Œæ‚¨éµå…¥ wg-quick up xxx.conf

å°‡å…©å€‹ç¶²å¡å•Ÿå‹•upä¸Šï¼Œå¯é€šémtr ç­‰å·¥å…· ä¾†pingå°ç«¯çš„Address è‹¥é€šï¼Œå³æ‚¨çš„wg tunnelå·²ç¶“å»ºç«‹ï¼



è¨­ç½®é–‹å•Ÿè‡ªèµ·å‹• å°æ‡‰ç¶²å¡

```
systemctl enable wg-quick@xxx
```

æ‚¨å¯ä»¥é€šéæ­¤å‘½ä»¤ ä¾†æª¢æ¸¬æ‚¨çš„wg tunnel ç‹€æ…‹&#x20;

```
wg show
```

### &#x20;ä¸€æ¬¡bugåé¦ˆ

æ•…äº‹æ˜¯è¿™æ ·çš„ï¼Œæˆ‘äºä»Šæ—¥åœ¨æŸä¸€å°åœ°åŸŸé…ç½®wgçš„æ—¶å€™ï¼Œupç½‘å¡æ—¶å‘ç”Ÿäº†

`RTNETLINK answers: Operation not supported`&#x20;

è¿™æ ·çš„æŠ¥é”™ã€‚

æ‚¨éœ€è¦åšçš„å°±æ˜¯é”®å…¥ä»¥ä¸‹å‘½ä»¤ æ£€æŸ¥æ‚¨çš„å†…æ ¸&#x20;

```
modprobe wireguard
```

æˆ‘è¿™è¾¹æ˜¾ç¤ºçš„`4.19.0.-22` æ‰€ä»¥æˆ‘é”®å…¥äº†ä»¥ä¸‹å‘½ä»¤&#x20;

```
apt install linux-headers-4.19.0-22-amd 
```

è‹¥æ‚¨çš„ç‰ˆæœ¬ä¸æ­¤ä¸åŒ è‡ªè¡Œä¿®æ”¹ï¼Œç„¶ååœ¨wg-quick up ç½‘å¡å°±è§£å†³æ­¤é—®é¢˜ï¼

### æœå‹™ç«¯åˆ°å®¢æˆ¶ç«¯

ä»¥ä¸‹ç‚ºå®¢æˆ¶ç«¯é…ç½®

```
[Interface]
PrivateKey = #[æ­¤è™•å¡«å¯«æœå‹™å™¨Bç”Ÿæˆçš„ å¯†é‘° PrivateKey]
Address =  #[æ­¤è™•å¡«å¯«æœå‹™å™¨B ifup link local address]
table = off


[Peer]
PublicKey = #[æ­¤è™•å¡«å¯«æœå‹™å™¨Aç«¯çš„å…¬é‘° PublicKey]
AllowedIPs = ::/0
EndPoint = [255.255.255.255]:00000 #[æ­¤è™•å¡«å¯«æœå‹™å™¨Aç«¯çš„ip/åŸŸåï¼šç«¯å£]
PersistentKeepalive = 25 #[ä¿æ´»ï¼Œé»˜èªç‚º25]
```

è€Œæœå‹™ç«¯å¯ä»¥ä¸å¡«å¯« å°ç«¯å®¢æˆ¶ç«¯ç«¯ Endpoint

æ³¨æ„å€åˆ† å…¬ç¥å’Œç§ç¥



æ•™ç¨‹åˆ°æ­¤ç»“æŸï¼Œå¦‚æœ‰å…¶ä»–ç–‘é—®ï¼Œå¯è¯¢é—®å…¶ä»–å¤§ä½¬ï¼Œä¹Ÿæ¬¢è¿å¤§ä½¬æ¥ç»™å’±æŒ‡æ­£ï¼



